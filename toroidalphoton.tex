\RequirePackage[l2tabu, orthodox]{nag}
\RequirePackage{fixltx2e}
\documentclass[twocolumn, 10pt, aps, superscriptaddress, floatfix, showpacs, prb, citeautoscript]{revtex4-1}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{bm}
\usepackage[utf8]{inputenc}
\usepackage{xcolor}
\usepackage[colorlinks, citecolor={blue!50!black}, urlcolor={blue!50!black}, linkcolor={red!50!black}]{hyperref}
\usepackage{bookmark}
\usepackage{tabularx}
\usepackage{mathtools}
\usepackage{microtype}

\setcounter{secnumdepth}{4}
\setcounter{tocdepth}{4}

\DeclareMathOperator{\e}{e}
\DeclareMathOperator{\de}{d\!}
\DeclareMathOperator{\Tr}{Tr}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\Res}{Res}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\Det}{Det}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\im}{Im}
\DeclareMathOperator{\re}{Re}
\newcommand{\vt}[1]{\mathbf{#1}}

\newcommand{\co}[2]{#2}
\renewcommand{\paragraph}{\co}

\DeclarePairedDelimiter\abs{\lvert}{\rvert}%
\DeclarePairedDelimiter\norm{\lVert}{\rVert}%
% Swap the definition of \abs* and \norm*, so that \abs
% and \norm resizes the size of the brackets, and the
% starred version does not.
\makeatletter
\let\oldabs\abs
\def\abs{\@ifstar{\oldabs}{\oldabs*}}
%
\let\oldnorm\norm
\def\norm{\@ifstar{\oldnorm}{\oldnorm*}}
\makeatother

\newcommand{\ev}[1]{\langle#1\rangle}
\newcommand{\bra}[1]{\langle #1|}
\newcommand{\ket}[1]{|#1\rangle}
\newcommand{\bracket}[2]{\langle #1|#2\rangle}

\newcolumntype{L}[1]{>{\raggedright\arraybackslash}p{#1}}
\newcolumntype{C}[1]{>{\centering\arraybackslash}p{#1}}
\newcolumntype{R}[1]{>{\raggedleft\arraybackslash}p{#1}}

\graphicspath{{figures/}}

\begin{document}

\title{Proposal for observation of toroidal Landau levels in driven dissipative photonic systems}


\author{A. C. Berceanu}
\affiliation{Departamento de F\'isica Te\'orica de la Materia
Condensada \& Condensed Matter Physics Center (IFIMAC), Universidad
Aut\'onoma de Madrid, Madrid 28049, Spain}
\author{Hannah M. Price}
\affiliation{INO-CNR BEC Center and Dipartimento di Fisica,
Universit\`{a} di Trento, I-38123 Povo, Italy}
\author{Tomoki Ozawa}
\affiliation{INO-CNR BEC Center and Dipartimento di Fisica,
Universit\`{a} di Trento, I-38123 Povo, Italy}
\author{Iacopo Carusotto}
\affiliation{INO-CNR BEC Center and Dipartimento di Fisica,
Universit\`{a} di Trento, I-38123 Povo, Italy}

\date{\today}

\begin{abstract}
  We study the Harper-Hofstadter model on a 2D square lattice in the
  presence of a weak harmonic trap, in the context of a
  driven-dissipative system. We extend the results of
  Ref.~\onlinecite{price2014magnetic} and propose an experimental
  scheme for the direct observation of toroidal Landau levels in
  momentum space in linear photonic systems.
\end{abstract}

\maketitle


\section{Introduction}

\paragraph{Quantum magnetism is interesting, even more so in momentum space.}
The study of electrons in a planar geometry under the influence of a
strong magnetic field gave rise to such interesting physics as the
integer and fractional quantum Hall effects. Quantum magnetism on
topologically nontrivial manifolds in momentum space, however, is less
well studied.  With the advent of synthetic gauge fields, new horizons
were opened for simulating quantum magnetism with neutral particles,
both in an atomic and photonic context.

\paragraph{Photonic systems are a good canditate for magnetism.}
Photonic systems are particularly advantageous for this type of
studies, since magnetic fluxes of the order of the flux quantum per
unit cell are now within experimental reach. Further advantages are
the ability to work at room temperature and the possibility of local
access to the optical field in driven-dissipative
systems~\cite{carusotto2013fluids}. This allows one to directly
observe the effects of such strong artificial gauge fields, by imaging
the photonic wavefunction.

\paragraph{Momentum space dual of HH model provides new insights.}
In Ref.~\onlinecite{price2014magnetic}, the authors considered the
Harper-Hofstadter model~\cite{hofstadter1976butterfly} on a 2D lattice
with the additional presence of a weak harmonic trapping potential. It
was shown that the energy spectrum is analogous to that of a particle
moving in momentum space on the surface of a torus, in constant
magnetic field.  The toroidal topology arises from the translational
symmetry of the model, while the constant magnetic field is provided
by the Berry curvature of the energy dispersion. Finally, the weak
quadratic potential plays the role of a kinetic energy term in
momentum space.

\paragraph{The main goal and its importance.}
The main goal of the current work is to extend the above-mentioned
results from the atomic case to the case of driven-dissipative
photonic systems. This would pave the way for the first direct
observation of toroidal Landau levels in momentum space.


\paragraph{Hafezi's arrays could be used for HH physics.}
Experimental developments have allowed the engineering of
topologically nontrivial energy bands, for example in the context of
exciton-polariton systems, where arrays of coupled micropillars were
used~\cite{jacqmin2014dirac}. However, the presence of optical
nonlinearities in such systems adds an extra layer of complexity.  We
therefore focus our present study on linear optical systems, such as
arrays of silicon-based coupled ring resonators.  With a proper design
of the resonator array~\cite{hafezi2013imaging}, this latter system
has been demonstrated to be accurately described by the
Harper-Hofstadter model with a strong and uniform artificial gauge
field piercing the lattice.  The harmonic trapping potential could
then be easily added as a modulation of the resonator size.


\paragraph{Summary of the manuscript}
After a short theoretical introduction to the model, we present the
main results of numerical simulations, followed by a viable proposal
for a photonics-based experiment. The validity of the approximations
we employ is discussed in the Appendix.

\section{Model}
\label{sec:model}

We consider a tight-binding model of non-interacting photons hopping
on a 2D square lattice, with nontrivial hopping phases created, for
instance, by using a synthetic gauge field. We also include an
additional harmonic trapping potential, so one can write the full Hamiltonian as

\begin{equation}\label{eq:model}
H=\mathcal{H}_0+\frac{1}{2}\kappa
\sum_{m,n}(m^{2}+n^{2})\hat{a}_{m,n}^{\dagger}\hat{a}_{m,n}.
\end{equation}

Here $\hat{a}_{m,n}^{\dagger}$ ($\hat{a}_{m,n}$) are the creation
(annihilation) operators for a photon at site $(m,n)$ and $\kappa$ is the
strength of the trap.

$\mathcal{H}_0$ is the Harper-Hofstadter Hamiltonian, the exact form
of which depends on the particular choice of gauge, through the
hopping phases $\phi = (\phi_x, \phi_y)$ (here $J$ is the real hoping
amplitude)
%
\begin{multline}\label{eq:hh_hamiltonian}
\mathcal{H}_0=-J\sum_{m,n}(e^{i \phi_x}\hat{a}_{m+1,n}^{\dagger}\hat{a}_{m,n}\\
+e^{i \phi_y}\hat{a}_{m,n+1}^{\dagger}\hat{a}_{m,n}) + \text{h.c.}
\end{multline}


In the Landau gauge only the hopping amplitude along $y$ is affected,
so we have $\phi = (0, 2\pi\alpha m)$, where $\alpha = \frac{p}{q}$ is
the number of magnetic flux quanta per unit cell ($p$ and $q$ are
coprime integers).

The symmetric gauge preserves rotational invariance so hopping terms
along both $x$ and $y$ are now affected: $\phi = (-\pi\alpha n,  \pi\alpha m)$.

Assuming the Landau gauge, one can diagonalize $\mathcal{H}_0$ in
momentum space, after defining a new, magnetic Brillouin zone (MBZ),
by introducing $p_x = p_x^0 + 2\pi \alpha m$. The resulting energy
bands $E_n(\vt{p})$ ($n = 1 \dots q$) have nontrivial topology, as
their Berry curvature $\Omega_n(\vt{p})$ is nonzero.

We work in the particular case of $\alpha=1/q$, the general case of
$p \neq 1$ involving degenerate energy bands with a non-Abelian Berry
connection.  For odd $q$, the Chern number of each band (except the
middle one) is -1. For large $q$, the Berry curvature of these bands
can be considered uniform, $\Omega_n(\vt{p}) = \Omega_n$, with an
average value $|\Omega_n| = \frac{1}{2\pi\alpha}$. Furthermore, if the
bandwidth is much smaller than the trapping energy we can also assume
$E_n(\vt{p}) = E_n$. For a detailed discussion of the approximations,
see Appendix~\ref{app:approximations}.

Using the dual momentum space interpretation of Eq.~\eqref{eq:model},
the eigenstates of $H$ for fixed $\alpha$ can then be written
as $q$ semi-infinite ladders:~\cite{price2014magnetic}
%
\begin{equation}\label{eq:ladders}
  \epsilon_{n,\beta} = E_n + \left(\beta + \frac{1}{2}\right) \kappa |\Omega_n|
\end{equation}
where we have introduced the Landau level quantum number
$\beta = 0,1,2,\dots$.

In the MBZ, the analytical expression (in the Landau gauge) for an
eigenstate $\beta$ as a function of the Hermite polynomials $H_\beta$
is known~\cite{price2014magnetic}:
%
\begin{multline}\label{eq:chi}
 \chi_\beta (\vt{p}) = \mathcal{N}_\beta^{l_{\Omega_n}} \sum_{j = -
 \infty}^{\infty} e^{- i p_y j a} e^{ - ( p_x + j a l_{\Omega_n}^2 )
 ^2 / 2 l_{\Omega_n}^2}\\
 \times H_\beta ( p_x / l_{\Omega_n} + j a
 l_{\Omega_n})
\end{multline}

Here $l_{\Omega_n} = \sqrt{\frac{1}{|\Omega_n|}}$ is the analogue of
the magnetic length and the normalisation constant is

\begin{equation}
\mathcal{N}_\beta^{l_{\Omega_n}} = \left( \frac{\sqrt{2/q}} {(2^\beta
\beta! \times 2 \pi l_{\Omega_n}^2)} \right)^{1/2}
\end{equation}

Following the treatment of Ref.~\onlinecite{ozawa2014qhe}, we now
include dissipation in the model by assuming uniform and local losses
characterized by the loss rate $\gamma$. The pump is assumed to be
monochromatic, with frequency $\omega_0$ and spatial profile
$f_{m,n}$.  Furthermore, as we are dealing with a noninteracting
system, we can safely replace the operators with their expectation
values and assume that their steady state evolution follows that of
the pump: $a_{m,n}(t) = a_{m,n} e^{-i \omega_0 t}$.

One then needs to solve the resulting Hamilton's equation of motion:
%
\begin{equation}
i\partial_{t}a_{i,j}(t)+i\gamma
a_{i,j}(t)-f_{i,j}e^{-i\omega_{0}t}=\left[a_{i,j}(t),H\right]
\end{equation}

Expressing $\omega_{0}$, $\gamma$, $\kappa$ and $f$ in units of $J$
and measuring distances in units of the lattice spacing we get
%
\begin{multline}\label{eq:linear_problem}
e^{-i\phi_x}a_{m+1,n}+e^{i\phi_x}a_{m-1,n}+e^{-i\phi_y}a_{m,n+1}+e^{i\phi_y}a_{m,n-1}\\
+\left[\omega_{0}+i\gamma-\frac{1}{2}\kappa
(m^{2}+n^{2})\right]a_{m,n}=f_{m,n}
\end{multline}
which is a set of linear equations to be solved numerically for each
lattice site.


\section{Results and discussion}
\label{sec:results}

We now present the main results of numerically solving
Eq.~\eqref{eq:linear_problem} for a lattice of
$N \times N = 45 \times 45$ sites, with $\kappa = 0.02$,
$\gamma = 0.001$ and $\alpha = 1/11$.  The numerical code was written
in Julia~\cite{bezanson2014julia} and is available online as ancillary
files for this preprint.

For simplicity we limit ourselves to pump frequencies which lie
withing the first ladder of states, given by Eq.~\eqref{eq:ladders}
for the case of $n = 1$.


\subsection{Selection rules}
\label{sec:selection}

\paragraph{The overlap between the pump state and the eigenstate determines the intensity.}
We first look at the intensity spectrum as a function of pump
frequency Fig.~\ref{fig:pumping_schemes}.  Whenever the pump frequency
$\omega_0$ is resonant with an eigenstate $\epsilon_{1,\beta}$ of the
Hamiltonian Eq.~\eqref{eq:model}, we should get a peak in the
spectrum. The peaks are of course broadened by the decay rate
$\gamma$, and their height depends on the overlap between the spatial
amplitude profile of the pump and the underlying eigenstate of $H$ at
that energy ($\hbar = 1$). Furthermore, as we are dealing with
gauge-dependent effects, the particular choice of gauge will also
affect the spectrum. To exemplify, we compare 4 different pumping
schemes in both the Landau and symmetric gauge.
%
\begin{figure}[htb]\centering
  \includegraphics[width=\linewidth]{selection}
  \caption{Intensity spectra for different pumping conditions: (a)
    pumping the single site (5,5), (b) pumping with a Gaussian
    profile, (c) homogeneous pumping and (d) pumping with a random
    phase. Black lines correspond to using the Landau gauge while
    green (dashed) ones to the symmetric gauge. The dotted vertical
    lines (with labels indicating the value of $\beta$)
    mark the states which were selected for later analysis.}
  \label{fig:pumping_schemes}
\end{figure}

We must emphasize that, while the absolute value of the real-space
wavefunction is identical in both gauges, its phase is not, and
neither is its momentum space representation (see
Fig.~\ref{fig:hom_mom_sp}). It is only the symmetric gauge which has a
well defined angular momentum. This is important when examining the
selection rules.

\paragraph{A δ pump in real space is homogeneous in momentum space.}
The simplest case is that of pumping a single site, with a pump of the
form $f_{m,n} = \delta_{m,m_0} \delta_{n,n_0}$. The pump is of course
homogeneous in momentum space, so one must think of real space when
explaining the shape Fig.~\ref{fig:pumping_schemes}, panel (a).
Indeed, the wavefunctions of $H$ in real space are rings of finite
width which increase in radius as the energy increases (see
Fig.~\ref{fig:delta_real_sp}). Therefore, if one pumps an off-center
site, there will only be a limited range of rings that will have radii
such as to overlap with the pump spot. Those are the states that
become visible. As the momentum space plays no role here, the result
in the Landau gauge will be identical.
%
\begin{figure}[htb]\centering
  \includegraphics[width=0.9\linewidth]{momentum}
  \caption{\emph{Top}: Homonegeous pumping, Landau gauge. Momentum
    space representation of the eigenstates corresponding to
    $\beta=0$, 1, 3 and 5.  
    \emph{Bottom}: Gaussian pump in the
    symmetric gauge. Momentum space representation of the eigenstates
    corresponding to $\beta=0$, 1, 9 and 20.}
  \label{fig:hom_mom_sp}
\end{figure}


\paragraph{Gaussian pumping is now bound also in momentum space.}
The next logical step in complexity is to use a Gaussian pump, a more
extended version of the $\delta$ pump. Its amplitude is given by
$f_{m,n} = \exp- \frac{1}{2\sigma^2} \left[(m-m_0)^2 + (n-n_0)^2
\right]$.
We take one which is also centered at $(m_0,n_0) = (5,5)$, with
$\sigma =1$. The main effect is, as expected, that now more states
become visible in both the low (smaller $\beta$) and high-energy
(larger $\beta$) sections of the spectrum. The intensity of the states
however is more difficult to explain, due to the overlap with pump in
momentum space. For example, as the symmetric gauge states have a
ring-like structure also in momentum space, the high energy portion of
the spectrum is washed out compared to its Landau gauge counterpart.

\paragraph{Homogeneous spectrum can be understood using a parity argument in momentum space.}
The limit of a very wide Gaussian is a homogeneous pump profile, and
that is what we consider in panel (c) of
Fig.~\ref{fig:pumping_schemes}. Now $f_{m,n} = f$, and the situation
looks very different in the 2 gauges.  In the Landau gauge we see only
half of the states. The reason for this particular selection rule
becomes apparent as one plots the eigenstates in momentum space, as
shown in the top row of Fig.~\ref{fig:hom_mom_sp}. We see that the
states with an odd value of $\beta$ have an odd number of nodes, with
one node in the center. This also has an analytical justification
given by the properties of the Hermite polynomials in
Eq.~\eqref{eq:chi}. Therefore the overlap between this set of states
and a homogeneous pump, which is a $\delta$ function in momentum
space, is nonexistent. 
%
\begin{figure}[htb]
  \centering
  \includegraphics[width=0.9\linewidth]{real}
  \caption{Real space representation of the states $\beta=0$, 6, 15
    and 26. The single site (5,5) was pumped.}
  \label{fig:delta_real_sp}
\end{figure}

The symmetric gauge, on the other hand, shows only the lowest
eigenstate, corresponding to $\beta=0$. That is because the angular
momentum of the pump itself is 0, therefore it cannot excite any state
with nonzero angular momentum. However, one could use, for instance, a
Gauss-Laguerre pump to address any particular state.

\paragraph{One must use a random phase in order to see all the states.}
In order to see the complete ladder of states, we chose a pump which
has a random site-dependent phase $\phi_{m,n}$:
$f_{m,n}=fe^{i\phi_{m,n}}$.  The phases are chosen from a random
normal distribution, and have values in the interval $[0,2\pi)$. The
bottom panel of Fig.~\ref{fig:pumping_schemes} was obtained by
averaging over 100 distinct realizations of these random phases. That
results in a relatively even intensity distribution, for both gauges.

%Lorentzian tails interfere.

\section{Experimental proposal}
\label{sec:experiment}

\paragraph{Greater dissipation implies spectral broadening.}
We now focus on a realistic system, within experimental reach. The
lattice size is $11 \times 11$ sites and the new value of the loss
rate is $\gamma = 0.0505$. This of course broadens the levels, making
them harder to resolve. Looking at Eq.~\eqref{eq:ladders}, we see that
the level spacing is given by $\frac{\kappa}{2\pi\alpha}$, so in order
to increase the spacing we must consider a stronger trap. We chose
$\kappa = 0.2$ and $\alpha = 1/7$. The first band of $\mathcal{H}_0$
is still relatively flat compared to the hopping $J$ for this value of
$\alpha$ and the bandwidth $E_2 - E_1$ is larger than before,
preventing the band mixing due to the stronger trap potential. For an
in-depth discussion we refer the reader to
Appendix~\ref{app:approximations}.

 We work in the Landau gauge and pump a single site,
situated on the upper border of the system, at $(m_0,n_0)= (0,5)$.

\begin{figure}[htb]
  \centering
  \includegraphics[width=0.9\linewidth]{exp_spect}
  \caption{\emph{Top}: Intensity spectrum for $N=11$ and
    $\gamma = 0.0505$. We filter at the energy of the eigenstate
    $\beta=7$ (long dashed line). The orange vertical dashed lines
    show the eigenstates of $H$ from Eq.~\eqref{eq:model}.
    \emph{Bottom}: Slice along the $p_x^0 = 0$ line in the MBZ (cont
    line, black) compared to the analytical prediction of
    Eq.~\eqref{eq:chi}, $|\chi_7(0,p_y)|^2$ (dotted line, blue). The
    orange dashed line shows the same slice for the non-dissipative
    case.}
%TODO: change label to $|\chi_7(0,p_y)|^2$
  \label{fig:exp_spectrum}
\end{figure}


The spectrum is shown in Fig.~\ref{fig:exp_spectrum}. Apart from the
expected broadening due to larger losses, we note that for frequencies
larger than -1.5 $J$ we start to see states from the second ladder
$\epsilon_{2,\beta}$. Their proximity to the first ladder states means
they cannot be resolved as separate peaks in the dissipative spectrum.

We filter at the energy indicated by the black dashed line and plot
the resulting emission in real and momentum space (full BZ), as well
as in the MBZ. For comparison, we also plot the wavefunction of the
Hamiltonian $H$ in Eq.~\eqref{eq:model} as the top row of
Fig.~\ref{fig:exp_states}. The difference between the two is of
course, the lack of pumping and dissipation of the latter. We see
that, even in the presence of finite size effects due to such a small
system, one can still distinguish the nodal structure of the emission
in momentum space, characteristic of a toroidal Landau level. 

Furthermore, as the expression of the wavefunction in MBZ for the
Landau gauge is given by Eq.~\eqref{eq:chi}, we can compare by taking
a slice along the $p_x^0 = 0$ line in the third column of
Fig.~\ref{fig:exp_states}. The result is shown in the bottom panel of
Fig.~\ref{fig:exp_spectrum} and shows good agreement with the
analytics.



\begin{figure}[htb]
  \centering
  \includegraphics[width=0.9\linewidth]{experimental}
  \caption{\emph{Top row}: Emission of the $\beta=7$ state in real
    (left column), momentum-space (middle column) and MBZ (right
    column) with no pumping or decay.
    \emph{Bottom row}: Emission from the state at $\omega_0 = -1.63$.
    The $\delta$-like pump at (0,5) is visible as a dark square.}
  \label{fig:exp_states}
\end{figure}

\section{Conclusion}
\label{sec:conclusion}

% higher level of analysis
% significance of the work

In conclusion, we have shown that toroidal Landau levels in momentum
space can readily be observed in linear driven-dissipative photonic
systems. Currently existing setups, such as the arrays of
silicon-based coupled ring resonators of
Ref.~\onlinecite{hafezi2013imaging} would make a prime candidate for
such an experiment.

\paragraph{One possible outlook is to include interactions.}
One interesting outlook would be to include the effect of photon-photon interactions in the model. When the synthetic gauge field is combined with strong interactions, one can hope to observe the hallmarks of the fractional quantum Hall physics.


\acknowledgments

ACB acknowledges financial support from the ESF through the POLATOM grant 4914.

HMP, TO and IC acknowledge financial support by the Autonomous Province of Trento, partially through the Call ``Grandi Progetti 2012", Project ``On silicon chip quantum optics for quantum computing and secure communications - SiQuro" and by the ERC through the QGBE grant.

\bibliographystyle{apsrev4-1}
\bibliography{topo}


\appendix

\section{Approximations}\label{app:approximations}


\paragraph{There are two main approximations in Hannah's paper.}
There are two main approximations that allow one to write
Eq.~\eqref{eq:ladders}. The first one is the so-called flat-band
approximation, where one neglects the momentum dependence of the
lowest Harper-Hofstadter band: $E_1(\vt{p}) = E_1$ and the second one is
assuming the trap is weak enough not to induce significant mixing with
the other energy bands (single-band approximation).

The Harper-Hofstadter Hamiltonian in Eq.~\eqref{eq:hh_hamiltonian} has
$q$ bands, which get exponentially flat in the limit of large
$q$. Focusing on the lowest band, we can define its width as
\begin{equation}
 BW = \max_{\vt{p}}(E_1(\vt{p})) - \min_{\vt{p}}(E_1(\vt{p})) 
\end{equation}

\paragraph{The scaling of bandwidth and bandgap with q is different.}
We also define the bandgap beween the lowest level and the next one as
\begin{equation}
  \Delta E = \left<E_2(\vt{p})\right>_{\vt{p}} - \left<E_1(\vt{p})\right>_{\vt{p}}
\end{equation}
Within this Appendix, as well as in the rest of the paper,
$\alpha=\frac{1}{q}$ so we plot these 2 quantities as a function of
$q$ in Fig.~\ref{fig:energy_bands}. We see indeed that the bandwidth
goes as $e^{-q}$, while the bandgap decreases as roughly
$\frac{1}{q}$.

\begin{figure}[htb]\centering
  \includegraphics[width=0.9\linewidth]{bands}
  \caption{Scaling of the bandwidth and bandgap for the
    Harper-Hofstadter Hamiltonian $\mathcal{H}_0$ of
    Eq.~\eqref{eq:hh_hamiltonian}.}
  \label{fig:energy_bands}
\end{figure}

To quantify the deviations from the eigenspectrum predicted by
Eq.~\eqref{eq:ladders} we introduce two dimensionless parameters,
$\eta_{\text{zpe}}$ and $\eta_{\text{lev}}$. The former quantifies the
deviations of the ``zero-point energy" from the predicted value while the
latter has to do with the level spacing within each ladder. For
simplicity, we only look at the first ladder of states and can write
the theoretical (as predicted by Eq.~\eqref{eq:ladders}) and ``real"
(as given by exact diagonalization of Eq.~\eqref{eq:model}) energies as

\begin{subequations}
  \begin{align}
    E_T &= \left<E_1(\vt{p})\right>_{\vt{p}} + \frac{1}{2}\frac{\kappa}{2\pi\alpha} + \beta \frac{\kappa}{2\pi\alpha}\\
    E_R &= \left<E_1(\vt{p})\right>_{\vt{p}} +
          (1+\eta_{\text{zpe}})\frac{1}{2}\frac{\kappa}{2\pi\alpha} +
          (1+\eta_{\text{lev}})\beta \frac{\kappa}{2\pi\alpha}
  \end{align}   
\end{subequations}


Rearranging, we get extract the ``zero-point energy" deviation
$\eta_{\text{zpe}} = \frac{4\pi\alpha}{\kappa} (E_R - E_T)$ and plot
it in Fig.~\ref{fig:zpe} for a range of trap strengths.

\paragraph{There is a positive contribution to the zero point energy error.}  
The second order term in perturbation theory when considering band
mixing induced by a external potential acts as a negative shift on the
lower energy band (while the first order contribution is zero by
definition). That would lead one to expect $\eta_{\text{zpe}}$ to be
negative for weak traps, as the inclusion of extra bands should lower
$E_R$ with respect to $E_T$.

\paragraph{Eigenstates for weak traps form in the minima of the band dispersion.}
We see that this is clearly not the case, as in fact
$\eta_{\text{zpe}}$ only becomes negative for extremely small values
of $\kappa \ll J$, as shown in Fig.~\ref{fig:error_small_kappa}.  That
is because the eigenstates of Eq.~\eqref{eq:model} for such weak
traps start forming in the minima of $E_1(\vt(p))$, which are below
the average value $\left<E_1(\vt{p})\right>_{\vt{p}}$.

\paragraph{This contribution is due to intra-band terms.}
To understand the positive contribution to $\eta_{\text{zpe}}$, one
has to realise that the single-band approximation of
Ref.~\onlinecite{price2014magnetic} does not discard all the
intra-band terms corresponding to first order in $\kappa$. It is these
terms which shift the whole $\epsilon_{1,\beta}$ ladder higher in
energy. Since the shift is uniform, the level spacing is not affected
so we expect (and indeed observe) $\eta_{\text{lev}}$ to be
negative. This contribution is dominant for small $\kappa$, where
second order corrections can be safely neglected. We indeed observe
that for stronger traps $\kappa > 1$, $\eta_{\text{zpe}}$ becomes
negative. There is an intermediate regime where these two
contributions cancel out and the ``zero-point energy" error is 0,
however one cannot find a suitable parameter range such that both
$\eta_{\text{zpe}}$ and $\eta_{\text{lev}}$ become zero.


\paragraph{The level spacing error is dominated by band-mixing effects. }
The level spacing error has a dependence on the Landau level quantum
number $\beta$ as
$\eta_{\text{lev}}(\beta) = \frac{2\pi \alpha}{\kappa} [E_R(\beta+1) -
E_R(\beta)] -1$
but in practice we only compute the energy difference between the
first two ladder states, taking $\beta = 0$. We observed that
$\eta_{\text{lev}}(0)$ has a similar profile to that of
Fig.~\ref{fig:zpe}, but a negative sign, as it is dominated by
band-mixing effects due to the breakdown of the single-band
approximation.


\begin{figure}[htb]\centering
  \includegraphics[width=0.5\linewidth]{zpe}
  \caption{``Zero-point energy" error, quantifying the deviation of
    $\epsilon_{1,0}$ from its predicted value given by Eq.~\eqref{eq:ladders}.}
  \label{fig:zpe}
\end{figure}





\begin{figure}[htb]\centering
  \includegraphics[width=0.9\linewidth]{weak_trap}
  \caption{In the limit of very weak traps $\kappa \ll J$, the
    ``zero-point energy" error becomes negative.}
  \label{fig:error_small_kappa}
\end{figure}


\end{document}
